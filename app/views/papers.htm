<nav id="papers-navbar" class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
            </button>
            <a class="navbar-brand page-scroll" href="#page-top"><img src="/img/logo.svg" height="34" title="" alt="DjLu" /> - {{ \models\User::instance()->getUsername() }}'s library</a>
        </div>

        <div class="collapse navbar-collapse" id="navbar">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#" id="js_pull"><i class="fa fa-refresh"></i> Pull</a></li>
                <li><a href="#" id="js_push"><i class="fa fa-cloud-upload"></i> Commit &amp; push</a></li>
                <li><a href="#" id="js_add"><i class="fa fa-plus"></i> Add a paper</a></li>
                <li><a href="{{ 'logout' | alias }}" id="js_logout"><i class="fa fa-sign-out"></i> Logout</a></li>
            </ul>
        </div>
    </div>
</nav>

<div id="papers-container">
    <div id="papers-col-left">
        <div id="papers-col-left-container">
            <loop from="{{ @i=0 }}" to="{{ @i < count(\models\Papers::$TAGS_GROUPS) }}" step="{{ @i++ }}">
                <ul class="nav">
                    <h3>{{ \models\Papers::$TAGS_GROUPS_LABELS[@i] }}</h3>
                    <repeat group="{{ @tags[\models\Papers::$TAGS_GROUPS[@i]] }}" key="{{ @tag }}" value="{{ @color }}">
                        <li class="group-link group_{{ @i }}" group-key="{{ @i }}" group-tag="{{ @tag }}"><span class="label label-default label-small" style="background: {{ @color }};">&nbsp;</span><span class="label label-default" style="background: {{ @color }}; color: {{ \lib\Formatting::textColorFromBgColor(@color); }}">{{ @tag }}</span></li>
                    </repeat>
                </ul>
                <p class="text-right"><span class="all-groups" group-key="group_{{ @i }}">All</span> | <span class="no-groups" group-key="group_{{ @i }}">None</span></p>
            </loop>
        </div>
    </div>
    <div id="papers-col-middle">
        <table class="table table-striped table-hover" id="papers-table">
            <thead>
            <tr id="papers-table-header">
                <th>Title</th>
                <th>Author</th>
                <th class="text-right">Publication</th>
                <th class="text-right">Added</th>
                <th data-toggle="tooltip" data-placement="top" title="Rating"></th>
            </tr>
            </thead>
            <tbody>
            <repeat group="{{ @papers }}" value="{{ @paper }}">
            <tr class="paper" data-paper-key="{{ @paper.key }}" id="paper-row-{{ @paper.key }}">
                <include href="paper.htm" />
            </tr>
            </repeat>
            </tbody>
        </table>
    </div>
    <div id="papers-col-right">
        <div id="papers-col-right-close"><i class="fa fa-close"></i></div>
        <div id="paper-placeholder">
            No paper selected
        </div>
        <div id="paper-wait" style="display: none;">
            <i class="fa fa-refresh faa-spin animated"></i>
        </div>
        <div id="paper-details" data-key="" style="display: none;">
            <h4 class="compact"><span class="title" data-key="title" data-title="Title"></span></h4>
            <p class="authorsContainer"><span class="authors" data-key="authors" data-title="Authors (semicolon separated)"></span></p>
            <p><strong>Citation key: </strong><span class="citationKey"></span></p>
            <p><strong>Pub. in: </strong><span class="in" data-key="in" data-title="Published in"></span></p>
            <p><strong>Year: </strong><span class="year" data-key="year" data-title="Year"></span></p>
            <p class="compact"><strong>Tags:</strong></p>
            <p class="compact"><em><abbr title="Content tags">C</abbr>: </em><span class="tags_content" data-key="tags_content" data-title="Tags about the content of the paper (semicolon separated)"></span></p>
            <p class="compact"><em><abbr title="Reading status tags">R</abbr>: </em><span class="tags_reading" data-key="tags_reading" data-title="Tags about the reading status (semicolon separated)"></span></p>
            <p><em><abbr title="Additional notes tags">N</abbr>: </em><span class="tags_notes" data-key="tags_notes" data-title="Tags to take super-short notes (semicolon separated)"></span></p>
            <p><strong>Added on: </strong><span class="date_added" data-key="date_added" data-title="Added on (YYYY-MM-DD HH:MM format)"></span></p>
            <p><strong>URL: </strong><span class="url" data-key="url" data-title="URL to the PDF"></span></p>
            <p><strong>Rating: </strong><span class="rating" data-key="rating" data-title="Rating (/5)"></span></p>
        </div>
        <div id="paper-notes" style="display: none;">
            <h4>Notes</h4>
            <hr>
            <div id="paper-notes-add" class="text-center">
                <button id="paper-notes-add-btn" class="btn btn-primary">Add notes</button>
            </div>
            <div id="paper-notes-content">
                <textarea id="paper-notes-editor"></textarea>
            </div>
        </div>
        <div id="paper-bibtex" style="display: none;">
            <h4>BibTex entry</h4>
            <hr>
            <pre id="paper-bibtex-content"></pre>
        </div>
    </div>
    <div id="papers-col-right-handle"></div>
    <div id="papers-col-right-open" style="display: none;"><i class="fa fa-caret-left"></i></div>
</div>

<!-- Modals -->
<div id="papers_modals">
    <div class="modal fade" id="js_pull_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title"><i class="fa fa-cloud-download"></i> Git pull</h4>
                </div>
                <div class="modal-body" id="js_pull_modal_content"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" id="js_pull_modal_close" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="js_pull_modal_reload">Reload</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="js_push_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title"><i class="fa fa-cloud-upload"></i> Git commit &amp; push</h4>
                </div>
                <div class="modal-body">
                    <div id="js_push_modal_status">
                        <p><strong>The following changes will be commited</strong></p>
                        <div id="js_push_modal_status_content"></div>
                    </div>
                    <div id="js_push_modal_message" class="form-group">
                        <label for="i_commit">Commit message</label>
                        <textarea class="form-control" rows="4" id="i_commit"></textarea>
                    </div>
                    <div id="js_push_modal_result">
                        <p class="text-center spinner"><i class="fa fa-refresh faa-spin animated"></i></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" id="js_push_modal_close" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="js_push_modal_send">Commit &amp; push</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="js_edit_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title"><i class="fa fa-pencil"></i> Edit a paper</h4>
                </div>
                <div class="modal-body">
                    <div id="js_edit_modal_form">
                        <div class="form-group">
                            <label for="i_edit" id="i_edit_label"></label>
                            <textarea class="form-control" rows="4" id="i_edit"></textarea>
                        </div>
                    </div>
                    <div id="js_edit_modal_wait">
                        <p class="text-center spinner"><i class="fa fa-refresh faa-spin animated"></i></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" id="js_edit_modal_close" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="js_edit_modal_send">Edit</button>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="js_add_modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title"><i class="fa fa-plus"></i> Add a paper</h4>
                </div>
                <div class="modal-body">
                    <form id="js_add_modal_input">
                        <div class="form-group">
                            <label for="i_citation_key">Citation key</label>
                            <input type="text" class="form-control" rows="9" id="i_citation_key" name="citationKey" />
                        </div>
                        <div class="form-group">
                            <label for="i_id">ID (arXiv ID or DOI)</label>
                            <input type="text" class="form-control" id="i_id" name="id" />
                        </div>
                        <div class="form-group">
                            <label for="i_bibtex">BibTex entry</label>
                            <textarea class="form-control" rows="9" id="i_bibtex" name="bibtex"></textarea>
                        </div>
                    </form>
                    <div id="js_add_modal_wait">
                        <p class="text-center spinner"><i class="fa fa-refresh faa-spin animated"></i></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="js_add_modal_send">Add</button>
                </div>
            </div>
        </div>
    </div>
</div>
